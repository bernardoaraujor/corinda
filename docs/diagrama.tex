


\tikzstyle{bloco} = [%
rectangle,
rounded corners,
draw=black,
fill=black!05,
thick,
inner sep=1mm,
minimum size=10mm,
]

\tikzstyle{input}=[%
circle,
draw=blue,
fill=blue!20,
text=black,
thick,
inner sep=0pt,
minimum size=10mm,
]

\tikzstyle{output} = [%
rectangle,
rounded corners,
draw=black!50,
fill=yellow!10,
thick,
inner sep=1mm,
minimum width=20mm,
minimum height=10mm,
]

\tikzstyle{fim} = [%
rectangle,
rounded corners=6mm,
draw=red,
fill=red!15,
text=black,
minimum height=12mm,
]

\subsubsection{Training}
\label{sec:training}

\begin{tikzpicture}
  [node distance=2mm and 10mm, thick]
  %% 
  \node (gamma) [input] {$\Gamma'$};
  %%
  \node (zxc) [bloco, right=of gamma] {zxcvbn};
  %% Modelos (CCM's)
  \node (modelo1) [output, above right=of zxc] {$\hat{m}_1,\theta_1,\mathcal{C}_1$};
  \node (modelo2) [output, below=of modelo1] {$\hat{m}_2,\theta_2,\mathcal{C}_2$};
  \node (ellipsis) [minimum width=20mm, minimum height=1mm, below=of modelo2] {\vdots};
  \node (modelo3) [output, below=of ellipsis] {$\hat{m}_n,\theta_n,\mathcal{C}_n$};
  \node (conjunto) [above=of modelo1.north] {$\mathcal{M}_\Gamma$};
  %%
  \draw [->] (gamma) -- (zxc);
  \draw [->] ($ (zxc.east) + (5mm, 0) $) |- ($ (modelo1.west) - (5mm, 0) $)
  -- (modelo1.west) ;
  \draw [->] (zxc.east) -- (modelo2.west);
  \draw [->] ($ (zxc.east) + (5mm, 0) $) |- ($ (modelo3.west) - (5mm, 0) $)
  -- (modelo3.west) ;
  %%
  \begin{scope}[on background layer]%
    \node [fill=black!15, %
    fit= (modelo1) (modelo2) (modelo3) (conjunto),%
    inner sep = 2.5mm,%
    minimum width=35mm,%
    ] {};
  \end{scope}
\end{tikzpicture}

\subsubsection{Passphrase strengh estimator}
\label{sec:passphrase-strenght-est}

\begin{tikzpicture}
  [node distance=10mm and 10mm,thick]
  %%
  \node (string) [input] { $\tilde{s}$ };
  %%
  \node (zxc) [bloco, right=of string] {zxcvbn};
  %%
  \node (ccm) [output, right=of zxc] { $ \hat{m},\ \mathcal{C} $ };
  %%
  \node (forca) [bloco, right=of ccm] { $ \mathfrak{S} $ };
  %%
  \node (modelos) [input, below=of forca] {$ \mathcal{M}_\Gamma $ };
  %%
  \node (saida) [fim, right=of forca] { $ G( \hat{m}\ |\ \mathcal{M}_\Gamma ) $};
  %%
  %% Setas
  \draw [->] (string) -- (zxc);
  \draw [->] (zxc) -- (ccm);
  \draw [->] (ccm) -- (forca);
  \draw [->] (modelos) -| (forca);
  \draw [->] (forca) -- (saida);

\end{tikzpicture}

\subsubsection{Hash Cracking}
\label{sec:hash-cracking}

\begin{tikzpicture}
  [node distance=2mm and 10mm, thick]

  \node (modelo1) [output] {$\hat{m}_1,\theta_1,\mathcal{C}_1$};
  \node (modelo2) [output, below=of modelo1] {$\hat{m}_2,\theta_2,\mathcal{C}_2$};
  \node (ellipsis) [minimum width=20mm, minimum height=1mm, below=of modelo2] {\vdots};
  \node (modelo3) [output, below=of ellipsis] {$\hat{m}_n,\theta_n,\mathcal{C}_n$};
  \node (conjunto) [above=of modelo1.north] {$\mathcal{M}_\Gamma$};
  %%
  \node (dicionarios) [input, below=5mm of modelo3] { $ \hat{\Lambda}_\Gamma$};
  %%
  \node (forca) [bloco, right=of modelo2] { $\mathfrak{S}$ };
  %% Hashcat
  \node (hashcat) [bloco, right=of forca] {\textsc{Hashcat}};
  %%
  \node (hashlist) [input, below=5mm of dicionarios] { $ H (\Gamma') $};
  
  %%
  \node (thread1) [output, above right=of hashcat] { $\hat{\lambda}_1, r_1$};
  \node (thread2) [output, below=of thread1] { $\hat{\lambda}_2, r_2$};
  \node (ellipsis) [minimum width=20mm, minimum height=1mm, below=of thread2] {\vdots};
  \node (thread3) [output, below=of ellipsis] { $\hat{\lambda}_3, r_3$};
  \node (threads) [above=of thread1.north,] {Cracking Proccess};
  %%
  \node (lookuptable) [fim, right=of thread2] { $ ( H(\Gamma''),\ \Gamma'')$};
  %%
  \node (obs1) [below=5mm of lookuptable] { $ \Gamma'' \subseteq \Gamma' $};

  %%
  \draw [->] (modelo1) -- ($ (modelo1.east) + (5mm, 0) $) |-
  ($ (forca.west) - (5mm, 0) $)-- (forca.west) ;
  \draw [->] (modelo2.east) -- (forca.west);%
  \draw [->] (modelo3) -- ($ (modelo3.east) + (5mm, 0) $) |-
  ($ (forca.west) - (5mm, 0) $) -- (forca.west) ;
  %%
  \begin{scope}[on background layer]%
    \node [fill=black!15, %
    fit= (modelo1) (modelo2) (modelo3) (conjunto) (dicionarios),%
    inner sep = 2.5mm,%
    minimum width=35mm,%
    ] {};
  \end{scope}
  %%
  \begin{scope}[on background layer]%
    \node [fill=black!15, %
    fit= (thread1) (thread2) (thread3) (threads),%
    inner sep = 2.5mm,%
    ] {};
  \end{scope}

  %%
  \draw [->] (forca) -- (hashcat);
  %%
  \draw [->] (hashlist) -| (hashcat);
  %%
  \draw [->] (dicionarios) -| ($(hashcat.south) - (2mm, 0)$);

  %%
  \draw [->] ($ (hashcat.east) + (5mm, 0) $) |- ($ (thread1.west) - (5mm, 0) $)
  -- (thread1.west) ;
  \draw [->] (hashcat.east) -- (thread2.west);
  \draw [->] ($ (hashcat.east) + (5mm, 0) $) |- ($ (thread3.west) - (5mm, 0) $)
  -- (thread3.west) ;
  %%
  \draw [->] (thread1) -- ($ (thread1.east) + (5mm, 0) $) |-
  ($ (lookuptable.west) - (5mm, 0) $)-- (lookuptable.west) ;
  \draw [->] (thread2.east) -- (lookuptable.west);%
  \draw [->] (thread3) -- ($ (thread3.east) + (5mm, 0) $) |-
  ($ (lookuptable.west) - (5mm, 0) $) -- (lookuptable.west) ;

\end{tikzpicture}


%%% Local Variables:
%%% coding: utf-8
%%% mode: latex
%%% TeX-master: "theory"
%%% End:
